[gd_scene load_steps=33 format=3 uid="uid://bfb4h625ijw6f"]

[ext_resource type="Script" path="res://scripts/CharacterController.gd" id="1"]
[ext_resource type="Script" path="res://scripts/Puzzle.gd" id="2"]
[ext_resource type="Script" path="res://scripts/PuzzleTile.gd" id="3"]
[ext_resource type="PackedScene" uid="uid://csn454ypieo0h" path="res://models/courtyard.glb" id="5"]
[ext_resource type="PackedScene" path="res://addons/kenney_prototypes/assets/colors/green/scenes/prototype_green_01.tscn" id="6"]
[ext_resource type="Script" path="res://scripts/PuzzleResponses/PuzzleResponseObjectMotion.gd" id="7"]

[sub_resource type="CapsuleShape3D" id="4"]
height = 1.5

[sub_resource type="PlaneMesh" id="8"]

[sub_resource type="VisualShaderNodeColorParameter" id="18"]
parameter_name = "main_colour"
default_value_enabled = true

[sub_resource type="VisualShader" id="14"]
code = "shader_type spatial;
uniform vec4 main_colour : source_color = vec4(1.000000, 1.000000, 1.000000, 1.000000);



void fragment() {
// ColorParameter:3
	vec4 n_out3p0 = main_colour;


// Output:0
	ALBEDO = vec3(n_out3p0.xyz);


}
"
graph_offset = Vector2(-462.207, -24.1574)
nodes/fragment/3/node = SubResource("18")
nodes/fragment/3/position = Vector2(-440, 120)
nodes/fragment/connections = PackedInt32Array(3, 0, 0, 0)

[sub_resource type="ShaderMaterial" id="15"]
render_priority = 0
shader = SubResource("14")
shader_parameter/main_colour = Color(1, 1, 1, 1)

[sub_resource type="VisualShaderNodeTexture2DParameter" id="19"]
parameter_name = "icon_texture"
color_default = 2

[sub_resource type="VisualShaderNodeColorParameter" id="35"]
parameter_name = "icon_colour"

[sub_resource type="VisualShaderNodeTexture" id="VisualShaderNodeTexture_5t5qw"]
source = 5

[sub_resource type="VisualShaderNodeVectorDecompose" id="VisualShaderNodeVectorDecompose_ppw8i"]
default_input_values = [0, Quaternion(0, 0, 0, 0)]
op_type = 2

[sub_resource type="VisualShader" id="12"]
code = "shader_type spatial;
uniform vec4 icon_colour : source_color;
uniform sampler2D icon_texture : hint_default_transparent;



void fragment() {
// ColorParameter:4
	vec4 n_out4p0 = icon_colour;


	vec4 n_out5p0;
// Texture2D:5
	n_out5p0 = texture(icon_texture, UV);


// VectorDecompose:6
	float n_out6p0 = n_out5p0.x;
	float n_out6p1 = n_out5p0.y;
	float n_out6p2 = n_out5p0.z;
	float n_out6p3 = n_out5p0.w;


// Output:0
	ALBEDO = vec3(n_out4p0.xyz);
	ALPHA = n_out6p3;


}
"
graph_offset = Vector2(-258.408, -112.247)
nodes/fragment/0/position = Vector2(760, 80)
nodes/fragment/3/node = SubResource("19")
nodes/fragment/3/position = Vector2(-1100, 260)
nodes/fragment/4/node = SubResource("35")
nodes/fragment/4/position = Vector2(-620, -180)
nodes/fragment/5/node = SubResource("VisualShaderNodeTexture_5t5qw")
nodes/fragment/5/position = Vector2(-340, 340)
nodes/fragment/6/node = SubResource("VisualShaderNodeVectorDecompose_ppw8i")
nodes/fragment/6/position = Vector2(152.53, 585.335)
nodes/fragment/connections = PackedInt32Array(3, 0, 5, 2, 5, 0, 6, 0, 6, 3, 0, 1, 4, 0, 0, 0)

[sub_resource type="ShaderMaterial" id="9"]
render_priority = 0
shader = SubResource("12")
shader_parameter/icon_colour = null

[sub_resource type="BoxShape3D" id="BoxShape3D_j73v0"]
size = Vector3(1, 0.05, 0.9)

[sub_resource type="BoxShape3D" id="17"]
size = Vector3(100, 1.8, 100)

[sub_resource type="BoxShape3D" id="37"]
size = Vector3(20, 4, 0.25)

[sub_resource type="BoxShape3D" id="39"]
size = Vector3(0.25, 4, 20)

[sub_resource type="BoxShape3D" id="38"]
size = Vector3(0.25, 4, 20)

[sub_resource type="BoxShape3D" id="41"]
size = Vector3(0.5, 5, 0.5)

[sub_resource type="BoxShape3D" id="40"]
size = Vector3(0.5, 5, 0.5)

[sub_resource type="BoxShape3D" id="42"]
size = Vector3(10, 4, 0.1)

[sub_resource type="BoxShape3D" id="43"]
size = Vector3(0.1, 4, 6.5)

[sub_resource type="BoxShape3D" id="44"]
size = Vector3(0.1, 4, 6.5)

[sub_resource type="BoxShape3D" id="45"]
size = Vector3(0.1, 4, 6.5)

[sub_resource type="BoxShape3D" id="46"]
size = Vector3(0.1, 4, 6.5)

[sub_resource type="BoxShape3D" id="36"]
size = Vector3(20, 0.001, 20)

[sub_resource type="BoxShape3D" id="47"]
size = Vector3(5, 2, 5)

[sub_resource type="Environment" id="Environment_j8joh"]
background_mode = 2
background_energy_multiplier = 1.09
ambient_light_color = Color(1, 1, 1, 1)
ambient_light_energy = 0.86

[node name="Node3D" type="Node3D"]

[node name="Player" type="CharacterBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2, 3)
axis_lock_angular_x = true
axis_lock_angular_z = true
script = ExtResource("1")
max_fall_speed = 1.0
camera_path = NodePath("PlayerCamera")

[node name="PlayerCapsule" type="CollisionShape3D" parent="Player"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.75, 0)
shape = SubResource("4")

[node name="PlayerCamera" type="Camera3D" parent="Player"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.05, 0)
current = true

[node name="TestPuzzle" type="Node3D" parent="."]
transform = Transform3D(0.1, 0, 0, 0, 0.1, 0, 0, 0, 0.1, -0.35, 1, 0)
script = ExtResource("2")
puzzle = [7.0, 5.0, 3.0, 2.0, 1.0, [[[1, 0, 0], [1, 0, 3], [4, 0, 2], [1, 0, 1], [7, 1, 1]], [[1, 0, 1], [1, 0, 1], [3, 0, 1], [4, 0, 2], [4, 0, 2]], [[1, 0, 0], [3, 0, 1], [3, 0, 3], [3, 0, 1], [7, 1, 0]], [[4, 0, 0], [6, 0, 1], [4, 0, 0], [6, 0, 1], [4, 0, 0]], [[1, 0, 0], [3, 0, 2], [3, 0, 0], [3, 0, 2], [7, 1, 0]], [[1, 0, 0], [1, 0, 0], [3, 0, 2], [4, 0, 2], [4, 0, 2]], [[1, 0, 0], [1, 0, 0], [4, 0, 0], [1, 0, 0], [7, 1, 0]]]]
check_intermediate = true
instance_path = NodePath("../Tile")

[node name="Tile" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0.0313179)
visible = false
script = ExtResource("3")
backplane_path = NodePath("Backplane")
icon_path = NodePath("Icon")

[node name="Backplane" type="CSGMesh3D" parent="Tile"]
transform = Transform3D(-0.5, -4.37114e-08, -1.91069e-15, 0, -2.18557e-08, 0.5, -4.37114e-08, 0.5, 2.18557e-08, 0, 0, 0)
mesh = SubResource("8")
material = SubResource("15")

[node name="Icon" type="CSGMesh3D" parent="Tile"]
transform = Transform3D(0.5, -4.37114e-08, 4.37114e-08, 4.37114e-08, -2.18557e-08, -0.5, 4.37114e-08, 0.5, -2.18557e-08, -4.37114e-10, -2.18557e-10, 0.005)
mesh = SubResource("8")
material = SubResource("9")

[node name="Area3D" type="Area3D" parent="Tile"]
transform = Transform3D(-1, -1.50996e-07, -6.60024e-15, 0, -4.37114e-08, 1, -1.50996e-07, 1, 4.37114e-08, 1.1228e-24, 0, -0.00672182)
monitoring = false
monitorable = false

[node name="CollisionShape3D" type="CollisionShape3D" parent="Tile/Area3D"]
shape = SubResource("BoxShape3D_j73v0")

[node name="TestCube" type="CharacterBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4, -2.05624, 2)
script = ExtResource("7")
displacement = Vector3(0, 5, 0)

[node name="CollisionShape3D" type="CollisionShape3D" parent="TestCube"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1)
shape = SubResource("17")

[node name="PrototypeCube2" parent="TestCube" instance=ExtResource("6")]

[node name="Courtyard" parent="." instance=ExtResource("5")]

[node name="Collision" type="StaticBody3D" parent="Courtyard"]

[node name="Walls" type="StaticBody3D" parent="Courtyard/Collision"]

[node name="South" type="CollisionShape3D" parent="Courtyard/Collision/Walls"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2, 10)
shape = SubResource("37")

[node name="West" type="CollisionShape3D" parent="Courtyard/Collision/Walls"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -10, 2, 0)
shape = SubResource("39")

[node name="East" type="CollisionShape3D" parent="Courtyard/Collision/Walls"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 10, 2, 0)
shape = SubResource("38")

[node name="Pillars" type="StaticBody3D" parent="Courtyard/Collision"]

[node name="Southwest" type="CollisionShape3D" parent="Courtyard/Collision/Pillars"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -5, 2, 5)
shape = SubResource("41")

[node name="Southeast" type="CollisionShape3D" parent="Courtyard/Collision/Pillars"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 5, 2, 5)
shape = SubResource("40")

[node name="Fences" type="StaticBody3D" parent="Courtyard/Collision"]

[node name="South" type="CollisionShape3D" parent="Courtyard/Collision/Fences"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2, 5)
shape = SubResource("42")

[node name="West-south" type="CollisionShape3D" parent="Courtyard/Collision/Fences"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -5, 2, 1.75)
shape = SubResource("43")

[node name="West-north" type="CollisionShape3D" parent="Courtyard/Collision/Fences"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -5, 2, -6.75)
shape = SubResource("44")

[node name="East-south" type="CollisionShape3D" parent="Courtyard/Collision/Fences"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 5, 2, 1.75)
shape = SubResource("45")

[node name="East-north" type="CollisionShape3D" parent="Courtyard/Collision/Fences"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 5, 2, -6.75)
shape = SubResource("46")

[node name="Ground" type="CollisionShape3D" parent="Courtyard/Collision"]
shape = SubResource("36")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Courtyard/Collision"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -2.5)
shape = SubResource("47")

[node name="Puzzles" type="Node3D" parent="Courtyard"]

[node name="Intro 1" type="Node3D" parent="Courtyard/Puzzles"]
transform = Transform3D(-4.37114e-08, 0, -1, 0, 1, 0, 1, 0, -4.37114e-08, 9.5, 3, -8)
script = ExtResource("2")
puzzle = [1.0, 3.0, 0, 0, 0, [[[7, 0, 0], [4, 0, 0], [7, 0, 0]]]]
instance_path = NodePath("../../../Tile")
on_complete_path = NodePath("../Intro 2")

[node name="Intro 2" type="Node3D" parent="Courtyard/Puzzles"]
transform = Transform3D(-4.37114e-08, 0, -1, 0, 1, 0, 1, 0, -4.37114e-08, 9.5, 3, -5)
script = ExtResource("2")
puzzle = [3.0, 3.0, 0, 0, 0, [[[7, 0, 1], [4, 0, 0], [7, 0, 1]], [[4, 0, 1], [6, 0, 1], [4, 0, 1]], [[7, 0, 1], [4, 0, 0], [7, 0, 1]]]]
instance_path = NodePath("../../../Tile")
on_complete_path = NodePath("../Intro 3")
load_on_start = false

[node name="Intro 3" type="Node3D" parent="Courtyard/Puzzles"]
transform = Transform3D(-2.62268e-08, 0, -0.6, 0, 0.6, 0, 0.6, 0, -2.62268e-08, 9.5, 3.2, 0)
script = ExtResource("2")
puzzle = [5.0, 5.0, 0, 0, 0, [[[1, 0, 0], [1, 0, 0], [4, 0, 0], [1, 0, 0], [7, 0, 0]], [[1, 0, 0], [1, 0, 0], [3, 0, 1], [3, 0, 0], [1, 0, 0]], [[4, 0, 1], [3, 0, 1], [7, 0, 0], [3, 0, 3], [4, 0, 1]], [[1, 0, 0], [3, 0, 2], [3, 0, 3], [1, 0, 0], [1, 0, 0]], [[7, 0, 0], [1, 0, 0], [4, 0, 0], [1, 0, 0], [1, 0, 0]]]]
instance_path = NodePath("../../../Tile")
on_complete_path = NodePath("../Intro 4")
load_on_start = false

[node name="Intro 4" type="Node3D" parent="Courtyard/Puzzles"]
transform = Transform3D(-4.37114e-08, 0, -1, 0, 1, 0, 1, 0, -4.37114e-08, 9.5, 3, 5)
script = ExtResource("2")
puzzle = [3.0, 3.0, 0, 0, 0, [[[7, 0, 0], [4, 0, 0], [7, 1, 0]], [[4, 0, 1], [4, 0, 0], [4, 0, 1]], [[7, 0, 0], [4, 0, 0], [7, 1, 0]]]]
instance_path = NodePath("../../../Tile")
on_complete_path = NodePath("../Intro 5")
load_on_start = false

[node name="Intro 5" type="Node3D" parent="Courtyard/Puzzles"]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 7, 3, 9.5)
script = ExtResource("2")
puzzle = [3.0, 3.0, 1.0, 1.0, 1.0, [[[1, 0, 0], [1, 0, 0], [1, 0, 0]], [[1, 0, 0], [2, 0, 0], [1, 0, 0]], [[1, 0, 0], [1, 0, 0], [1, 0, 0]]]]
check_intermediate = true
instance_path = NodePath("../../../Tile")
on_complete_path = NodePath("../Intro 6")
load_on_start = false

[node name="Intro 6" type="Node3D" parent="Courtyard/Puzzles"]
transform = Transform3D(-1, 0, -1.50996e-07, 0, 1, 0, 1.50996e-07, 0, -1, 2, 3.2, 9.5)
script = ExtResource("2")
puzzle = [3.0, 3.0, 1.0, 2.0, 1.0, [[[1, 0, 0], [1, 0, 3], [1, 0, 0]], [[4, 0, 2], [3, 0, 1], [4, 0, 0]], [[7, 0, 2], [4, 0, 1], [7, 0, 2]]]]
check_intermediate = true
instance_path = NodePath("../../../Tile")
load_on_start = false

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_j8joh")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="WorldEnvironment"]
transform = Transform3D(1, 0, 0, 0, -0.765146, 0.643857, 0, -0.643857, -0.765146, 0, 7.22089, -12.8683)

[connection signal="input_event" from="Tile/Area3D" to="Tile" method="input_event"]
[connection signal="mouse_entered" from="Tile/Area3D" to="Tile" method="mouse_enter"]
[connection signal="mouse_exited" from="Tile/Area3D" to="Tile" method="mouse_exit"]
